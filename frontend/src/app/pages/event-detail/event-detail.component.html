<!-- src/app/pages/event-detail/event-detail.component.html -->
<div class="max-w-6xl mx-auto" *ngIf="!isLoading && eventDetails">
  
  <!-- Back Button and Header -->
  <div class="mb-6">
    <button
      (click)="goBack()"
      class="flex items-center gap-2 text-primary hover:text-primary/80 mb-4"
    >
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      <span>Back to search</span>
    </button>

    <div class="flex justify-between items-start">
      <h1 class="text-3xl font-bold">{{ eventDetails.name }}</h1>
      
      <button
        (click)="toggleFavorite()"
        class="p-2 hover:bg-gray-100 rounded-full"
      >
        <svg
          class="w-8 h-8"
          [class.fill-red-500]="isFavorite()"
          [class.text-red-500]="isFavorite()"
          [class.fill-none]="!isFavorite()"
          [class.text-black]="!isFavorite()"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
        </svg>
      </button>
    </div>

    <!-- Buy Tickets Link -->
    <div class="mt-4">
      <span class="text-gray-600">Buy Ticket At: </span>
      <a
        [href]="eventDetails.url"
        target="_blank"
        class="text-primary hover:underline"
      >
        Ticketmaster
      </a>
    </div>
  </div>

  <!-- Tabs -->
  <div class="bg-white rounded-lg shadow-md">
    <!-- Tab Headers -->
    <div class="border-b">
      <div class="flex">
        <button
          (click)="setActiveTab('info')"
          [class.border-b-2]="activeTab === 'info'"
          [class.border-primary]="activeTab === 'info'"
          [class.text-primary]="activeTab === 'info'"
          class="px-6 py-3 font-medium hover:bg-gray-50"
        >
          Info
        </button>
        <button
          (click)="setActiveTab('artists')"
          [class.border-b-2]="activeTab === 'artists'"
          [class.border-primary]="activeTab === 'artists'"
          [class.text-primary]="activeTab === 'artists'"
          [disabled]="!isMusicEvent"
          [class.opacity-50]="!isMusicEvent"
          [class.cursor-not-allowed]="!isMusicEvent"
          class="px-6 py-3 font-medium hover:bg-gray-50"
        >
          Artists/Teams
        </button>
        <button
          (click)="setActiveTab('venue')"
          [class.border-b-2]="activeTab === 'venue'"
          [class.border-primary]="activeTab === 'venue'"
          [class.text-primary]="activeTab === 'venue'"
          class="px-6 py-3 font-medium hover:bg-gray-50"
        >
          Venue
        </button>
      </div>
    </div>

    <!-- Tab Content -->
    <div class="p-6">
      
      <!-- Info Tab -->
      <div *ngIf="activeTab === 'info'">
        <div class="space-y-4">
          <!-- Date -->
          <div *ngIf="eventDetails.dates?.start?.localDate">
            <strong>Date:</strong> 
            {{ eventDetails.dates.start.localDate }} 
            <span *ngIf="eventDetails.dates.start.localTime">{{ eventDetails.dates.start.localTime }}</span>
          </div>

          <!-- Artists/Teams -->
          <div *ngIf="artists.length > 0">
            <strong>Artists/Team:</strong>
            {{ getArtistNames() }}
          </div>

          <!-- Venue -->
          <div *ngIf="venue">
            <strong>Venue:</strong> {{ venue.name }}
          </div>

          <!-- Genres -->
          <div>
            <strong>Genres:</strong> {{ getGenres() }}
          </div>

          <!-- Price Range -->
          <div>
            <strong>Price Range:</strong> {{ getPriceRange() }}
          </div>

          <!-- Ticket Status -->
          <div>
            <strong>Ticket Status:</strong>
            <span 
              [ngClass]="getTicketStatus().class"
              class="inline-block px-3 py-1 rounded-md ml-2"
            >
              {{ getTicketStatus().text }}
            </span>
          </div>

          <!-- Buy Ticket At -->
          <div>
            <strong>Buy Ticket At:</strong>
            <a
              [href]="eventDetails.url"
              target="_blank"
              class="text-primary hover:underline ml-2"
            >
              Ticketmaster
            </a>
          </div>

          <!-- Seat Map -->
          <div *ngIf="eventDetails.seatmap?.staticUrl">
            <strong>Seat Map:</strong>
            <div class="mt-2">
              <img
                [src]="eventDetails.seatmap.staticUrl"
                alt="Seat Map"
                class="max-w-md border rounded-lg"
              />
            </div>
          </div>

          <!-- Social Share -->
          <div class="flex gap-4 mt-6">
            <button
              (click)="shareOnFacebook()"
              class="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
            >
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
              Share on Facebook
            </button>
            
            <button
              (click)="shareOnTwitter()"
              class="flex items-center gap-2 px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800"
            >
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
              Share on X
            </button>
          </div>
        </div>
      </div>

      <!-- Artists/Teams Tab -->
      <div *ngIf="activeTab === 'artists'">
        <div *ngIf="isLoadingArtists" class="text-center py-12">
          <div class="animate-spin h-12 w-12 border-4 border-primary border-t-transparent rounded-full mx-auto"></div>
          <p class="mt-4 text-gray-600">Loading artist information...</p>
        </div>

        <div *ngIf="!isLoadingArtists && spotifyArtists.length === 0" class="text-center py-12 text-gray-500">
          No artist information available
        </div>

        <div *ngIf="!isLoadingArtists && spotifyArtists.length > 0" class="space-y-8">
          <div *ngFor="let artist of spotifyArtists" class="border-b pb-6 last:border-b-0">
            <div class="flex items-start gap-6">
              <!-- Artist Image -->
              <img
                *ngIf="artist.images?.[0]"
                [src]="artist.images[0].url"
                [alt]="artist.name"
                class="w-32 h-32 object-cover rounded-lg"
              />

              <!-- Artist Info -->
              <div class="flex-1">
                <h3 class="text-2xl font-bold mb-3">{{ artist.name }}</h3>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                  <div>
                    <strong>Followers:</strong> {{ formatFollowers(artist.followers?.total) }}
                  </div>
                  <div>
                    <strong>Popularity:</strong> {{ artist.popularity }}%
                  </div>
                  <div class="col-span-2">
                    <strong>Spotify:</strong>
                    <a
                      [href]="artist.external_urls?.spotify"
                      target="_blank"
                      class="text-primary hover:underline ml-2"
                    >
                      Open in Spotify
                    </a>
                  </div>
                </div>

                <!-- Albums -->
                <div *ngIf="artist.albums && artist.albums.length > 0">
                  <h4 class="font-bold mb-2">Albums:</h4>
                  <div class="grid grid-cols-3 gap-4">
                    <div *ngFor="let album of artist.albums" class="text-center">
                      <img
                        *ngIf="album.images?.[0]"
                        [src]="album.images[0].url"
                        [alt]="album.name"
                        class="w-full aspect-square object-cover rounded-md mb-2"
                      />
                      <p class="text-sm font-medium line-clamp-2">{{ album.name }}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Venue Tab -->
      <div *ngIf="activeTab === 'venue' && venue">
        <div class="space-y-4">
          <!-- Venue Name -->
          <div>
            <strong>Name:</strong> {{ venue.name }}
          </div>

          <!-- Address -->
          <div *ngIf="getVenueAddress() !== 'N/A'">
            <strong>Address:</strong>
            <a
              (click)="openGoogleMaps()"
              class="text-primary hover:underline cursor-pointer ml-2"
            >
              {{ getVenueAddress() }}
            </a>
          </div>

          <!-- See Events Button -->
          <div *ngIf="venue.url">
            <button
              (click)="openVenueEvents()"
              class="px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90"
            >
              See Events
            </button>
          </div>

          <!-- Venue Image -->
          <div *ngIf="venue.images?.[0]">
            <strong>Image:</strong>
            <div class="mt-2">
              <img
                [src]="venue.images[0].url"
                [alt]="venue.name"
                class="max-w-2xl rounded-lg"
              />
            </div>
          </div>

          <!-- Parking Info -->
          <div *ngIf="venue.parkingDetail">
            <strong>Parking Info:</strong>
            <p class="mt-1">{{ venue.parkingDetail }}</p>
          </div>

          <!-- General Rule -->
          <div *ngIf="venue.generalInfo?.generalRule">
            <strong>General Rule:</strong>
            <p class="mt-1">{{ venue.generalInfo.generalRule }}</p>
          </div>

          <!-- Child Rule -->
          <div *ngIf="venue.generalInfo?.childRule">
            <strong>Child Rule:</strong>
            <p class="mt-1">{{ venue.generalInfo.childRule }}</p>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- Loading State -->
<div *ngIf="isLoading" class="flex justify-center items-center py-20">
  <div class="animate-spin h-12 w-12 border-4 border-primary border-t-transparent rounded-full"></div>
</div>